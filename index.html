<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Train Booking System</title>
  <script src="https://www.gstatic.com/firebasejs/9.0.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.2/firebase-database.js"></script>
</head>
<body>
  <h1>Train Booking System</h1>
  
  <div>
    <label for="boarding">Boarding Station: </label>
    <input type="text" id="boarding" placeholder="Enter Boarding Station">
    <label for="destination">Destination Station: </label>
    <input type="text" id="destination" placeholder="Enter Destination Station">
    <button id="searchButton">Search Trains</button>
  </div>

  <div id="trainResults">
    <h2>Available Trains</h2>
    <ul id="trainList"></ul>
    <p id="noTrainsMessage" style="color: red;"></p> <!-- Message for no trains found -->
  </div>

  <script>
    // Firebase configuration
    const firebaseConfig = {
      authDomain: "train-booking-system-6bba0.firebaseapp.com",
      databaseURL: "https://train-booking-system-6bba0-default-rtdb.firebaseio.com",
      projectId: "train-booking-system-6bba0",
      storageBucket: "train-booking-system-6bba0.appspot.com",
      messagingSenderId: "400655444474",
      appId: "1:400655444474:web:4626f33a141197779a1c43"
    };

    // Initialize Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const database = firebase.database(app);

    // Function to handle search and display available trains
    document.getElementById("searchButton").addEventListener("click", function() {
      const boarding = document.getElementById("boarding").value.trim();
      const destination = document.getElementById("destination").value.trim();
      const trainList = document.getElementById("trainList");
      const noTrainsMessage = document.getElementById("noTrainsMessage");

      // Clear previous results and error message
      trainList.innerHTML = "";
      noTrainsMessage.textContent = "";

      if (boarding && destination) {
        // Query the Firebase database for trains
        const trainsRef = database.ref("trains");
        trainsRef.once("value", function(snapshot) {
          const trains = snapshot.val();
          
          let foundTrains = false;
          
          // Loop through the trains and display those matching the query
          for (const trainId in trains) {
            const train = trains[trainId];
            
            // Check if the train matches the boarding and destination stations
            if (train.boarding.toLowerCase() === boarding.toLowerCase() && 
                train.destination.toLowerCase() === destination.toLowerCase()) {
              foundTrains = true;

              // Create an element for each matching train
              const listItem = document.createElement("li");
              listItem.innerHTML = `
                <strong>${train.name}</strong><br>
                Departure: ${train.departure}<br>
                Arrival: ${train.arrival}<br>
                Boarding: ${train.boarding}<br>
                Destination: ${train.destination}<br>
                <button>Book Now</button>
              `;
              trainList.appendChild(listItem);
            }
          }
          
          if (!foundTrains) {
            // Show message if no matching trains are found
            noTrainsMessage.textContent = "No trains available for the selected stations.";
          }
        });
      } else {
        alert("Please enter both boarding and destination stations.");
      }
    });
  </script>
</body>
</html>
